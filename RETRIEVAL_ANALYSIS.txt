â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         PHONE & SETTINGS RETRIEVAL - DETAILED ANALYSIS              â•‘
â•‘                   craftswear.com Remote Inspection                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DATE: November 20, 2025
ENDPOINT: https://craftswear.com/wp-admin/admin-ajax.php

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… TEST 1: PHONE RETRIEVAL
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Database Phone Value:    +919100454045
Sanitized Format:        +919100454045
URL Format (wa.me):      919100454045

âœ… RETRIEVAL CHAIN:
   1. get_option('onlive_wa_order_settings') â†’ Retrieved âœ“
   2. $settings['phone'] â†’ "+919100454045" âœ“
   3. Phone sanitization â†’ preg_replace('/[^0-9\+]/', '') âœ“
   4. URL format â†’ ltrim('+') â†’ "919100454045" âœ“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… TEST 2: URL GENERATION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Generated URLs with Phone:
   https://wa.me/919100454045?text=...

Sample Product URL:
   https://wa.me/919100454045?text=Hi%21%20Interested%20in%20
   Oxblood%20Patina%20-%20Brogue%20Apron%20...%20Qty%3A%201

âœ… Phone extraction from URL: 919100454045 âœ“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… TEST 3: TEMPLATE CONFIGURATION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Template Enabled:        1 (true) âœ“
Template Location:       Database (onlive_wa_order_settings)
Custom Template:         Enabled & Saved âœ“

CUSTOM TEMPLATE TEXT:
   "Hi! Interested in {{product_name}} â€“ {{product_variation}}. 
    Qty: {{product_quantity}} â€¢ Price: {{product_price}} 
    Please send more info."

TEMPLATE VARIABLES SUPPORTED:
   {{product_name}}        - Product title
   {{product_variation}}   - Selected variation (e.g., "Color: Red")
   {{product_quantity}}    - Quantity ordered
   {{product_price}}       - Product price with currency
   {{product_sku}}         - Product SKU
   {{product_link}}        - Product URL (when enabled)
   {{site_name}}           - Your store name
   {{customer_name}}       - Customer name placeholder
   {{cart_total}}          - Cart total

âœ… RETRIEVAL CHAIN:
   1. get_setting('template_enabled', false) â†’ true âœ“
   2. get_setting('message_template', '') â†’ Template text âœ“
   3. Placeholder replacement â†’ Applied correctly âœ“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… TEST 4: ALL SETTINGS LOADED
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

TOTAL SETTINGS: 16 items

1.  enabled                    â†’ 1 (enabled)
2.  phone                      â†’ +919100454045 âœ“
3.  positions[single]          â†’ 1 (show on single product)
4.  positions[cart]            â†’ 1 (show on cart page)
5.  button_label_single        â†’ "Order on WhatsApp"
6.  button_label_cart          â†’ "Order on WhatsApp"
7.  button_color              â†’ #25D366 (WhatsApp green)
8.  button_text_color         â†’ #FFFFFF (white)
9.  button_size               â†’ medium
10. template_enabled           â†’ 1 (custom template enabled) âœ“
11. message_template           â†’ Custom template text âœ“
12. load_css                   â†’ 1 (load plugin styles)
13. custom_css                 â†’ "" (no custom CSS)
14. include_product_link       â†’ 1 (include {{product_link}})
15. api_choice                 â†’ auto
16. custom_query_param         â†’ text

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… TEST 5: SETTINGS PAGE VERIFICATION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

WHERE PHONE IS RETRIEVED FROM SETTINGS PAGE:

File: admin/settings-page.php
Lines: 303-310

    public function field_phone_number() {
        $value = $this->option( 'phone', '' );
        ?>
        <input type="text" class="regular-text" id="onlive-wa-phone" 
               name="<?php echo esc_attr( $this->option_name ); ?>[phone]" 
               value="<?php echo esc_attr( $value ); ?>" 
               placeholder="+11234567890" />
        <?php
    }

RETRIEVAL FLOW:
   1. $this->option('phone', '') calls: get_option('onlive_wa_order_settings')
   2. WordPress retrieves settings from wp_options table
   3. Phone value "+919100454045" is extracted
   4. Sanitization in form: sanitize_text_field()
   5. Stored back with preg_replace('/[^0-9\+]/', '') validation
   6. On frontend: get_setting('phone') returns "+919100454045"

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… TEST 6: TEMPLATE RETRIEVAL FROM SETTINGS PAGE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

WHERE TEMPLATE IS RETRIEVED FROM SETTINGS PAGE:

File: admin/settings-page.php
Lines: 403-415 (field_template_toggle)
Lines: 416-430 (field_message_template)

TEMPLATE TOGGLE FIELD:
    public function field_template_toggle() {
        $enabled = (bool) $this->option( 'template_enabled', false );
        ?>
        <input type="hidden" name="...][template_enabled]" value="0" />
        <label>
            <input type="checkbox" ... value="1" 
                   <?php checked( $enabled ); ?> />
            Custom message template
        </label>
        <?php
    }

TEMPLATE TEXT FIELD:
    public function field_message_template() {
        $template = (string) $this->option( 'message_template', '' );
        ?>
        <textarea id="onlive-wa-template" 
                  name="...][message_template]" 
                  rows="5" class="large-text">
            <?php echo esc_textarea( $template ); ?>
        </textarea>
        <?php
    }

RETRIEVAL FLOW:
   1. get_setting('template_enabled', false) â†’ 1 (true) âœ“
   2. get_setting('message_template', '') â†’ Custom template text âœ“
   3. In AJAX handler: Check if template_enabled
   4. If true: Use custom template, else use default
   5. Replace placeholders with actual values
   6. Generate message for WhatsApp

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… TEST 7: AJAX REQUEST FLOW
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

REQUEST EXAMPLE:
   curl -X POST "https://craftswear.com/wp-admin/admin-ajax.php" \
     -d "action=vaog2jucg3f2&context=product&product_id=653" \
     -H "X-Requested-With: XMLHttpRequest"

RESPONSE FLOW:
   1. Bootstrap handler intercepts request âœ“
   2. Loads WordPress (wp-load.php) âœ“
   3. get_option('onlive_wa_order_settings') called âœ“
   4. All 16 settings retrieved âœ“
   5. Phone: "+919100454045" extracted âœ“
   6. Template enabled: true âœ“
   7. Custom template: Applied âœ“
   8. URL generated: https://wa.me/919100454045?text=... âœ“
   9. Debug info included in response âœ“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸŽ¯ CONCLUSION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… PHONE RETRIEVAL:        WORKING CORRECTLY
   â€¢ Source: Database (wp_options.onlive_wa_order_settings)
   â€¢ Value: +919100454045
   â€¢ Format: 919100454045 (in URL)
   â€¢ In URL: YES - https://wa.me/919100454045?text=...

âœ… TEMPLATE RETRIEVAL:     WORKING CORRECTLY
   â€¢ Status: Enabled (1)
   â€¢ Source: Database (wp_options.onlive_wa_order_settings)
   â€¢ Custom template: Loaded & Applied
   â€¢ Variables: Replaced correctly

âœ… SETTINGS RETRIEVAL:     COMPLETE
   â€¢ Total: 16 settings items
   â€¢ All accessible: YES
   â€¢ get_option() working: YES
   â€¢ WordPress integration: VERIFIED

âœ… AJAX HANDLER:           RESPONDING CORRECTLY
   â€¢ Bootstrap handler: Active
   â€¢ Headers required: X-Requested-With: XMLHttpRequest
   â€¢ Response format: Valid JSON
   â€¢ Debug info: Included

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
STATUS: âœ… PRODUCTION READY

All retrieval mechanisms verified and working correctly.
Phone number and templates are properly stored and retrieved.
No issues detected in the retrieval chain.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
